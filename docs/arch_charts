<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Auth Signer System Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            padding: 2rem;
        }
        .container {
            max-width: 90%;
            margin: 0 auto;
            background-color: #ffffff;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .mermaid {
            overflow-x: auto;
            border-radius: 0.5rem;
            padding: 1rem;
            background-color: #e5e7eb;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body class="bg-gray-100 p-8">

    <div class="container text-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">Enhanced Auth Signer System Architecture</h1>
        <p class="text-gray-600 mb-6">Complete system architecture incorporating all functionality from transcripts: CME MVP with 500+ monthly changes, 15-16 business line scalability, OCR integration, digital signatures, and comprehensive workflows.</p>
    </div>

    <div class="container">
        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Enterprise Platform Overview</h2>
        <div id="enterprise-overview" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Internal User Management & Authentication</h2>
        <div id="internal-user-auth" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Internal User Signer Management Workflow</h2>
        <div id="internal-signer-mgmt" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">External User Onboarding & Authentication</h2>
        <div id="external-user-onboarding" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">External User Self-Service Workflow</h2>
        <div id="external-self-service" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">OCR & Document Processing Integration</h2>
        <div id="ocr-processing" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Digital Signature Workflow</h2>
        <div id="digital-signature" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Multi-Business Line Configuration</h2>
        <div id="business-line-config" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Enhanced Data Model with All Tables</h2>
        <div id="enhanced-data-model" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Integration Architecture & Dependencies</h2>
        <div id="integration-dependencies" class="mermaid text-left"></div>

        <h2 class="text-xl font-semibold text-gray-700 mt-6 mb-2">Epic Structure & Development Flow</h2>
        <div id="epic-development" class="mermaid text-left"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    <script>
        const diagrams = {
            'enterprise-overview': `
                graph TD
                    EO1["Auth Signer Enterprise Platform<br/>• Reusable across 15-16 business lines<br/>• CME MVP: 500+ monthly changes<br/>• Target: Weeks to hours processing<br/>• Single source of truth for ASL data"]
                    EO2["Business Lines Roadmap<br/>• Phase 1: CME (Q4 2025)<br/>• Phase 2: IT&C (Q1 2026)<br/>• Phase 3: GSF, GCT (Q2 2026)<br/>• Each with unique business rules"]
                    EO3["Core Value Proposition<br/>• Eliminate manual email processes<br/>• Real-time status tracking<br/>• Self-service client portal<br/>• Automated compliance validation"]
                    EO4["Technical Foundation<br/>• Spring Boot microservice<br/>• React UI in Corporate Connect<br/>• SQL Server with audit trails<br/>• OCR/AI document processing"]

                    EO1 --> EO2
                    EO2 --> EO3
                    EO3 --> EO4
            `,
            'internal-user-auth': `
                graph TD
                    IUA1[Internal User Login<br/>SSO via Corporate Connect<br/>Role-based authentication] --> IUA2[Entitlement Validation<br/>Business line access check<br/>Account-level permissions]

                    IUA2 --> IUA3{User Role?}
                    IUA3 --> IUA4[Client Manager<br/>• CME portfolio access<br/>• Approval authority<br/>• Client relationship mgmt]
                    IUA3 --> IUA5[Product Operations<br/>• Cross-business line access<br/>• Processing capabilities<br/>• Bulk upload rights]
                    IUA3 --> IUA6[Trust Review<br/>• Compliance validation<br/>• Risk assessment<br/>• Audit capabilities]
                    IUA3 --> IUA7[Risk Partners<br/>• KYC validation<br/>• Fraud verification<br/>• Escalation handling]

                    IUA4 --> IUA8[User Management Dashboard<br/>• Account search by customer ID<br/>• Signer type filtering<br/>• Status overview]
                    IUA5 --> IUA8
                    IUA6 --> IUA8
                    IUA7 --> IUA8

                    IUA8 --> IUA9[Access Control Matrix<br/>• View permissions by business line<br/>• Edit rights per account type<br/>• Approval workflow assignment]
            `,
            'internal-signer-mgmt': `
                graph TD
                    ISM1[Select Customer/Account<br/>Search by customer ID<br/>View associated accounts] --> ISM2[Choose Account<br/>Deposits, investments, loans<br/>Different signers per account]

                    ISM2 --> ISM3{Action Required?}
                    ISM3 --> ISM4[Add New Signer<br/>Personal info collection<br/>Authorization type selection]
                    ISM3 --> ISM5[Edit Existing Signer<br/>Editable: name, phone, email<br/>Non-editable: DOB, account numbers]
                    ISM3 --> ISM6[Remove Signer<br/>Maintain minimum thresholds<br/>Transfer permissions if needed]
                    ISM3 --> ISM7[View/Audit History<br/>7+ years retention<br/>Compliance reporting]

                    ISM4 --> ISM8[Collect Required Data<br/>Name, title, email, phone<br/>Business address, entity name<br/>Third-party info if applicable]
                    ISM8 --> ISM9[Digital Signature Capture<br/>Upload signature file<br/>KMS/HSM integration<br/>Signature validation]
                    ISM9 --> ISM10[Authorization Type Selection<br/>Single signer, dual approval<br/>Dollar limit thresholds<br/>Business line specific rules]
                    ISM10 --> ISM11[Validation Engine<br/>Business rule enforcement<br/>Duplicate checking<br/>Compliance verification]

                    ISM5 --> ISM12[Field Edit Validation<br/>Personal info: editable<br/>Title changes allowed<br/>Account associations: add/remove only]
                    ISM6 --> ISM13[Removal Validation<br/>Check minimum signer requirements<br/>Primary user restrictions<br/>Transfer workflow if needed]

                    ISM11 --> ISM14{Approval Required?}
                    ISM12 --> ISM14
                    ISM13 --> ISM14

                    ISM14 -->|No| ISM15[Direct Processing<br/>Update ASL database<br/>WebKYC sync<br/>Notification sent]
                    ISM14 -->|Yes| ISM16[Multi-Person Approval<br/>Task assignment<br/>Reviewer notification<br/>Status tracking]

                    ISM16 --> ISM17[Approval Decision<br/>Review and comments<br/>Approve/deny action<br/>Escalation if needed]
                    ISM17 --> ISM18{Approved?}
                    ISM18 -->|Yes| ISM15
                    ISM18 -->|No| ISM19[Rejection Handling<br/>Feedback to initiator<br/>Resubmission option]
            `,
            'external-user-onboarding': `
                graph TD
                    EUO1[Client Request Initiation<br/>Email, phone, or portal<br/>Existing vs new client] --> EUO2{Client has CC Account?}

                    EUO2 -->|Yes| EUO3[Standard CC Login<br/>Existing credentials<br/>ASL section access]
                    EUO2 -->|No| EUO4[OCR Document Processing<br/>Paper form upload<br/>AI data extraction]

                    EUO4 --> EUO5[Confidence Score Review<br/>AI extraction accuracy<br/>Manual correction if needed]
                    EUO5 --> EUO6[Guest Token Generation<br/>24-hour expiration<br/>Single-use for changes<br/>IP address validation]

                    EUO6 --> EUO7[Secure Email Delivery<br/>Unique token URL<br/>Security instructions<br/>Expiration notice]
                    EUO7 --> EUO8[Client Token Validation<br/>URL click verification<br/>Token authenticity check<br/>Access provisioning]

                    EUO8 --> EUO9{Valid Access?}
                    EUO9 -->|No| EUO10[Access Denied<br/>Security logging<br/>New token option]
                    EUO9 -->|Yes| EUO11[Guest Dashboard<br/>Extracted data review<br/>Edit capabilities<br/>Submission workflow]

                    EUO3 --> EUO12[Full CC Access<br/>Complete ASL management<br/>Real-time tracking<br/>Export capabilities]
                    EUO11 --> EUO13[Limited Guest Access<br/>Review and confirm only<br/>No direct submissions<br/>Banker validation required]
            `,
            'external-self-service': `
                graph TD
                    ESS1[Client Dashboard Access<br/>Current ASL display<br/>Pending request status<br/>Real-time updates] --> ESS2{Self-Service Action?}

                    ESS2 --> ESS3[Add Signer Request<br/>Standardized form<br/>Validation rules<br/>Business line requirements]
                    ESS2 --> ESS4[Remove Signer Request<br/>Select from current list<br/>Confirmation workflow<br/>Impact assessment]
                    ESS2 --> ESS5[Update Signer Info<br/>Limited field editing<br/>Contact information<br/>Title/role changes]
                    ESS2 --> ESS6[Annual Attestation<br/>List accuracy confirmation<br/>Digital signature required<br/>Compliance documentation]
                    ESS2 --> ESS7[Export/Print ASL<br/>Business line templates<br/>PDF generation<br/>Official formatting]

                    ESS3 --> ESS8[Form Validation<br/>Required field check<br/>Format verification<br/>Business rule application]
                    ESS4 --> ESS8
                    ESS5 --> ESS8
                    ESS6 --> ESS9[Digital Attestation<br/>Legal binding signature<br/>Timestamp recording<br/>Certificate generation]
                    ESS7 --> ESS10[Template Processing<br/>Business line specific verbiage<br/>Logo and formatting<br/>Download capability]

                    ESS8 --> ESS11[Request Submission<br/>Status: PENDING<br/>Tracking number assigned<br/>Email confirmation]
                    ESS9 --> ESS12[Attestation Complete<br/>Legal documentation<br/>Compliance record<br/>Next due date set]

                    ESS11 --> ESS13[Automated Processing<br/>Validation engine<br/>Approval routing<br/>Status updates]
                    ESS13 --> ESS14[Client Notification<br/>Status change alerts<br/>Email updates<br/>Dashboard refresh]
            `,
            'ocr-processing': `
                graph TD
                    OCR1[Document Receipt<br/>Email, fax, or upload<br/>Multiple format support<br/>Quality assessment] --> OCR2[Document Categorization<br/>Business line identification<br/>Form type recognition<br/>Priority assignment]

                    OCR2 --> OCR3[OCR/AI Processing<br/>Cognizant partnership<br/>ML model execution<br/>Data extraction]
                    OCR3 --> OCR4[Confidence Scoring<br/>Field-level accuracy<br/>Overall document score<br/>Quality metrics]

                    OCR4 --> OCR5{Confidence Threshold?}
                    OCR5 -->|High Confidence| OCR6[Auto-Accept<br/>Direct data import<br/>Minimal review needed<br/>Fast processing]
                    OCR5 -->|Medium Confidence| OCR7[Review Required<br/>Banker validation<br/>Selective correction<br/>Approval workflow]
                    OCR5 -->|Low Confidence| OCR8[Manual Processing<br/>Full data entry<br/>Original document review<br/>Quality verification]

                    OCR6 --> OCR9[Data Validation<br/>Business rule check<br/>Format verification<br/>Duplicate detection]
                    OCR7 --> OCR10[Human Review Interface<br/>Side-by-side comparison<br/>Edit capabilities<br/>Approval tracking]
                    OCR8 --> OCR11[Manual Entry Form<br/>Guided data input<br/>Validation assistance<br/>Error prevention]

                    OCR9 --> OCR12[System Integration<br/>Database update<br/>Workflow initiation<br/>Status notification]
                    OCR10 --> OCR12
                    OCR11 --> OCR12

                    OCR12 --> OCR13[Historical Migration<br/>7+ years processing<br/>Batch operations<br/>Progress tracking]
            `,
            'digital-signature': `
                graph TD
                    DS1[Signature Requirement<br/>Legal compliance need<br/>Authentication purpose<br/>Non-repudiation] --> DS2{Signature Type?}

                    DS2 --> DS3[Client Self-Service<br/>Web-based signature pad<br/>Touch/mouse capture<br/>Mobile compatibility]
                    DS2 --> DS4[Document Signing<br/>PDF signature overlay<br/>Certificate embedding<br/>Timestamp inclusion]
                    DS2 --> DS5[Biometric Signature<br/>Advanced authentication<br/>Multi-factor verification<br/>High-security scenarios]

                    DS3 --> DS6[Signature Capture<br/>Vector data recording<br/>Pressure sensitivity<br/>Speed tracking]
                    DS4 --> DS7[Document Processing<br/>File modification<br/>Security embedding<br/>Integrity protection]
                    DS5 --> DS8[Biometric Validation<br/>Identity verification<br/>Match scoring<br/>Security clearance]

                    DS6 --> DS9[KMS/HSM Integration<br/>Cryptographic signing<br/>Certificate management<br/>Key rotation]
                    DS7 --> DS9
                    DS8 --> DS9

                    DS9 --> DS10[Signature Verification<br/>Authenticity check<br/>Tampering detection<br/>Legal validity]
                    DS10 --> DS11[Storage & Archival<br/>Immutable records<br/>Audit trail creation<br/>Compliance documentation]

                    DS11 --> DS12[Integration Points<br/>ASL request signing<br/>Attestation signatures<br/>Approval workflows<br/>Bulk operation signing]
            `,
            'business-line-config': `
                graph TD
                    BLC1[Business Line Matrix<br/>15-16 lines supported<br/>Configurable rules<br/>No code changes] --> BLC2{Business Line?}

                    BLC2 --> BLC3[CME Configuration<br/>dual_approval_required: true<br/>max_auth_limit: 1000000<br/>approval_timeout: 48hrs<br/>required_fields: email,phone,title]
                    BLC2 --> BLC4[IT&C Configuration<br/>dual_approval_required: false<br/>max_auth_limit: 500000<br/>approval_timeout: 24hrs<br/>required_fields: email,address]
                    BLC2 --> BLC5[GSF Configuration<br/>dual_approval_required: true<br/>max_auth_limit: 2500000<br/>approval_timeout: 72hrs<br/>compliance_level: enhanced]
                    BLC2 --> BLC6[GCT Configuration<br/>dual_approval_required: varies<br/>trust_validation: required<br/>document_retention: permanent<br/>regulatory_reporting: quarterly]

                    BLC3 --> BLC7[CME Workflow Rules<br/>• Client Manager approval always<br/>• Risk review for high amounts<br/>• Callback verification required<br/>• WebKYC integration enhanced]
                    BLC4 --> BLC8[IT&C Workflow Rules<br/>• Product Ops single approval<br/>• Streamlined processing<br/>• Auto-approval thresholds<br/>• Simplified documentation]
                    BLC5 --> BLC9[GSF Workflow Rules<br/>• Complex approval chains<br/>• Multiple stakeholder review<br/>• Enhanced documentation<br/>• Regulatory compliance checks]
                    BLC6 --> BLC10[GCT Workflow Rules<br/>• Trust-specific validations<br/>• Fiduciary responsibility checks<br/>• Legal document requirements<br/>• Trustee approval workflows]

                    BLC7 --> BLC11[Configuration Engine<br/>Key-value pair storage<br/>Runtime rule application<br/>Dynamic workflow routing<br/>Business logic adaptation]
                    BLC8 --> BLC11
                    BLC9 --> BLC11
                    BLC10 --> BLC11
            `,
            'enhanced-data-model': `
                graph TD
                    EDM1[accounts<br/>• account_id (PK)<br/>• business_line (CME,ITC,GSF,GCT)<br/>• client_id, account_name<br/>• account_type (deposits,investments,loans)<br/>• status, created_date]

                    EDM2[authorized_signers<br/>• signer_id (PK)<br/>• account_id (FK)<br/>• first_name, last_name, middle_name<br/>• email, phone, title<br/>• business_address, entity_name<br/>• privilege_level, authorization_limit<br/>• effective_date, expiration_date<br/>• status, signature_on_file]

                    EDM3[asl_requests<br/>• request_id (PK)<br/>• account_id (FK)<br/>• request_type (ADD,REMOVE,UPDATE,ATTEST)<br/>• initiated_by, initiated_date<br/>• status (DRAFT,PENDING,APPROVED,REJECTED)<br/>• approval_required, dual_approval_needed<br/>• business_justification<br/>• completed_date]

                    EDM4[asl_request_details<br/>• detail_id (PK)<br/>• request_id (FK), signer_id (FK)<br/>• action (ADD,REMOVE,UPDATE)<br/>• before_data (JSON)<br/>• after_data (JSON)<br/>• change_reason<br/>• validation_status]

                    EDM5[asl_approvals<br/>• approval_id (PK)<br/>• request_id (FK)<br/>• approver_id, approver_role<br/>• approval_level (1,2,3)<br/>• status (PENDING,APPROVED,DENIED)<br/>• comments, approved_date<br/>• delegation_info]

                    EDM6[asl_audit_log<br/>• log_id (PK)<br/>• account_id, signer_id<br/>• action, changed_by<br/>• change_timestamp<br/>• before_state (JSON)<br/>• after_state (JSON)<br/>• source_system<br/>• ip_address, session_id<br/>• compliance_flags]

                    EDM7[guest_tokens<br/>• token_id (PK)<br/>• account_id (FK)<br/>• email_address<br/>• token_hash, salt<br/>• expires_at, used_at<br/>• ip_address, user_agent<br/>• access_scope<br/>• created_date]

                    EDM8[asl_documents<br/>• document_id (PK)<br/>• request_id (FK)<br/>• document_name, document_type<br/>• file_path, filenet_id<br/>• ocr_processed, ocr_confidence_score<br/>• manual_review_required<br/>• document_hash<br/>• uploaded_by, uploaded_date]

                    EDM9[business_line_configs<br/>• config_id (PK)<br/>• business_line<br/>• config_key, config_value<br/>• data_type (STRING,BOOLEAN,NUMBER)<br/>• effective_date, expiration_date<br/>• created_by, modified_by]

                    EDM10[digital_signatures<br/>• signature_id (PK)<br/>• signer_id (FK), request_id (FK)<br/>• signature_data (encrypted)<br/>• signature_type<br/>• certificate_id, timestamp<br/>• verification_status<br/>• legal_validity]

                    EDM11[third_party_info<br/>• tp_id (PK)<br/>• signer_id (FK)<br/>• tp_name, tp_address<br/>• tp_contact_info<br/>• authorization_scope<br/>• verification_documents<br/>• status, created_date]

                    EDM12[account_signer_associations<br/>• association_id (PK)<br/>• account_id (FK), signer_id (FK)<br/>• association_type<br/>• effective_date, expiration_date<br/>• permissions (JSON)<br/>• status]

                    EDM1 --> EDM2
                    EDM1 --> EDM3
                    EDM1 --> EDM12
                    EDM2 --> EDM4
                    EDM2 --> EDM10
                    EDM2 --> EDM11
                    EDM3 --> EDM4
                    EDM3 --> EDM5
                    EDM3 --> EDM8
                    EDM12 --> EDM2
            `,
            'integration-dependencies': `
                graph TD
                    ID1[Critical Path Dependencies<br/>Must resolve before development] --> ID2[WebKYC Team Integration<br/>• API documentation needed<br/>• Test environment access<br/>• Compliance validation rules<br/>• Retry/fallback procedures]

                    ID1 --> ID3[Service Request Platform<br/>• Susie's team coordination<br/>• Workflow initiation APIs<br/>• Task management integration<br/>• Status synchronization]

                    ID1 --> ID4[Guest User Provisioning<br/>• Jessica Roswell's team<br/>• Authentication requirements<br/>• OTP vs full account decision<br/>• Security team approval]

                    ID2 --> ID5[Development Blockers<br/>• Cannot complete approval workflows<br/>• Compliance validation incomplete<br/>• Production deployment blocked]

                    ID3 --> ID6[Parallel Development Options<br/>• Mock service implementation<br/>• Independent workflow testing<br/>• Future integration planning]

                    ID4 --> ID7[Security Architecture Impact<br/>• Token management strategy<br/>• Authentication flow design<br/>• Guest access limitations]

                    ID1 --> ID8[Onboarding Team Collaboration<br/>• GSF/GCT parallel development<br/>• Data format standardization<br/>• Future integration planning<br/>• CME independence confirmed]

                    ID1 --> ID9[OCR/AI Partnership<br/>• Cognizant team engagement<br/>• Confidence threshold setting<br/>• Historical document processing<br/>• Parallel manual entry development]

                    ID8 --> ID10[Strategic Alignment<br/>• Future data feed automation<br/>• Process standardization<br/>• Cross-business line consistency]

                    ID9 --> ID11[Technical Risk Mitigation<br/>• Manual fallback always available<br/>• Confidence scoring requirements<br/>• Review workflow implementation]
            `,
            'epic-development': `
                graph TD
                    ED1[Epic 1: Internal User Authentication<br/>• Corporate Connect SSO<br/>• Entitlement validation<br/>• Role-based access control<br/>• Session management<br/>Size: M (3-4 sprints)] --> ED2[Epic 2: Internal User Signer Management<br/>• Add/edit/remove signers<br/>• Approval workflows<br/>• Historical audit access<br/>• Document management<br/>Size: XL (5-6 sprints)]

                    ED1 --> ED3[Epic 3: External User Onboarding<br/>• Guest token provisioning<br/>• OCR document processing<br/>• Email delivery system<br/>• Access validation<br/>Size: L (4-5 sprints)]

                    ED3 --> ED4[Epic 4: External User Self-Service<br/>• ASL dashboard<br/>• Self-service forms<br/>• Real-time status tracking<br/>• Export capabilities<br/>Size: XL (5-6 sprints)]

                    ED2 --> ED5[Foundational Services<br/>• Database schema complete<br/>• Core APIs functional<br/>• Authentication working<br/>• Basic CRUD operations]

                    ED4 --> ED6[Client Experience Complete<br/>• Full self-service capability<br/>• Guest user support<br/>• Real-time notifications<br/>• Export/print functionality]

                    ED5 --> ED7[Integration Phase<br/>• WebKYC connection<br/>• FileNet integration<br/>• OCR service setup<br/>• Bulk processing]

                    ED6 --> ED7

                    ED7 --> ED8[Production Readiness<br/>• Performance testing<br/>• Security validation<br/>• Compliance approval<br/>• Go-live preparation]

                    ED8 --> ED9[CME MVP Launch<br/>• 500+ monthly changes<br/>• Weeks to hours improvement<br/>• Client satisfaction gains<br/>• Operational efficiency]

                    ED9 --> ED10[Business Line Expansion<br/>• IT&C onboarding (Q1 2026)<br/>• GSF/GCT integration (Q2 2026)<br/>• Additional lines (2026+)<br/>• Platform scaling]
            `
        };

        window.onload = function() {
            mermaid.initialize({
                startOnLoad: false,
                theme: 'default',
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                }
            });

            for (const [id, code] of Object.entries(diagrams)) {
                const element = document.getElementById(id);
                if (element) {
                    mermaid.render('mermaid-svg-' + id, code)
                        .then(({ svg }) => {
                            element.innerHTML = svg;
                        })
                        .catch(error => {
                            element.innerHTML = `<pre>Error rendering diagram: ${error.message}</pre>`;
                            console.error('Mermaid rendering error for diagram ID ' + id + ':', error);
                        });
                }
            }
        };
    </script>

</body>
</html>
